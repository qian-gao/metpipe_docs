{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Computational workflow documentation","text":"<p>CBMR metabolomics platform </p>"},{"location":"#workflow","title":"Workflow","text":"<p>This section provides general guidelines for the computational workflow for metabolomics. </p>"},{"location":"#r-package-metpipe","title":"R package: metpipe","text":"<p>metpipe is a R package dedicated for metabolomics data processing pipeline.</p>"},{"location":"#web-application-data-explorer","title":"Web application: Data explorer","text":"<p>Data explorer is a shiny web application based on metpipe package. It provides a series tools facilitating metabolomics data processing, exploration and visualization. </p>"},{"location":"data_explorer/calibration/","title":"Calibration","text":""},{"location":"data_explorer/data_explorer/","title":"Data explorer user guide","text":"<p>An instruction</p>"},{"location":"data_explorer/data_explorer/#generate-sample-list","title":"Generate sample list","text":""},{"location":"data_explorer/data_explorer/#input","title":"Input","text":""},{"location":"data_explorer/data_explorer/#original-sample-name-file","title":"Original sample name file:","text":"<p>xlsx file should contain at least four columns - Name, Project, Method, Date 1. Name: put sample names in this column 2. Project, Method, Date only need input in the first row 3. Method: should be filled in without ionization mode 4. Date: DDMMYYYY, e.g. 10112021</p>"},{"location":"data_explorer/data_explorer/#set-qc-samples","title":"Set QC samples","text":"<p>Initial block of samples: samples at the beginning of the run Cycle block of samples: samples repeating during the run Final block of samples: samples at the end of the run Cycle size: number of samples between cycle blocks</p>"},{"location":"data_explorer/data_explorer/#sample-type","title":"Sample type","text":"<p>sol: solvent BL: extraction blank PO: pool PO-12-5, PO-25, PO-50, PO-100: pool sample with different dilution CP: clinical pool BP: batch pool NIST: NIST SRM 1950 plasma CAL: calibration curve IQ: QC samples M-Mix: Master mix</p>"},{"location":"data_explorer/data_explorer/#customize-plate","title":"Customize plate","text":"<p>If samples already have fixed positions on the plate, these information should be provided in column 'Position' in the uploaded sample name file</p>"},{"location":"data_explorer/data_explorer/#randomization","title":"Randomization","text":"<p>Block randomization: Extra columns with stratum variables need to be provided in the sample name file If subject is used as stratum, it should be provided in column 'Subject' in the uploaded sample name file</p>"},{"location":"data_explorer/data_explorer/#match-library","title":"Match library","text":""},{"location":"data_explorer/data_explorer/#peak-table-file","title":"Peak table file","text":"<p>xlsx file should contain sheets named either 'POS' or 'NEG' indicating ionization mode: 1. If match peaktable by identity, there should be at least one column names 'Identity', which is the identity of the feature. This identity should be from the column 'Library.name' from library 2. If match peaktable by RT and m/z, the first three columns should be 'id', 'rt', 'mz'</p>"},{"location":"data_explorer/data_explorer/#rt-mapping","title":"RT mapping","text":""},{"location":"data_explorer/data_explorer/#retention-time-mappping-file","title":"Retention time mappping file:","text":"<p>Consist of 2 sheets (Method 1) or 3 sheets (Method 2) Method 1: - Sheet 1: two columns of retention time from analytical method a and b, columm 'Identity' is optional - Sheet 2: one column of retention time to predict from analytical method a, columm 'Identity' is optional. Retention time in analytical method b will be predicted</p> <p>Method 2: - Sheet 1: peaktable from analytical method a, the first 3 columns are - retention time, m/z, identity. Samples start from 4th column - Sheet 2: peaktable from analytical method b, same format as Sheet 1 - Sheet 3: one column of retention time to predict from analytical method a, columm 'Identity' is optional. Retention time pairs from analytical method a and b will be selected based on m/z difference and correlation. Then using the RT pairs as reference, retention time in analytical method b will be predicted</p>"},{"location":"data_explorer/data_explorer/#calibration","title":"Calibration","text":""},{"location":"data_explorer/data_explorer/#calibration-curve-file","title":"Calibration curve file:","text":"<ol> <li>Consist of two sheet: first sheet, intensities of calibration curve First sheet, intensities of calibration curve Second sheet, concentrations of calibration curve</li> <li>Names of internal standards should start with 'IS_'</li> <li>Samples should be arranged by increasing concentrations</li> <li>Technical replicates should be next to each other</li> <li>If intensities of calibration curve is 0, replace it with 0.01</li> </ol>"},{"location":"data_explorer/data_explorer/#peak-table-file_1","title":"Peak table file:","text":"<ol> <li>The same format as the first sheet in calibration curve file</li> </ol> <p>Smooth parameter: Decrease the number to make the curve more smooth</p>"},{"location":"data_explorer/data_explorer/#upload","title":"Upload","text":""},{"location":"data_explorer/data_explorer/#peaks-files","title":"Peaks files:","text":"<p>csv or xlsx files exported from preprocessing software such as MZMine 2 1. The column name for retention time, m/z and identity should be the following 'rt', 'mz', 'Identity' 2. Samples should start from the 8th column</p>"},{"location":"data_explorer/data_explorer/#internal-standard-file","title":"Internal standard file:","text":"<p>csv or xlsx files exported from preprocessing software such as MZMine 2 1. The column name for retention time, m/z and identity should be the following 'rt', 'mz', 'Identity' 2. Samples should start from the 8th column</p>"},{"location":"data_explorer/data_explorer/#study-design-file-optional","title":"Study design file (optional):","text":"<p>csv or xlsx files containing information about samples 1. The column name for sample name should be 'Sample.name' 2. If sample names are not informative, column 'Sample.type' and 'Batch' should be included to indicate the sample type and batch information</p>"},{"location":"data_explorer/data_explorer/#preprocessing","title":"Preprocessing","text":""},{"location":"data_explorer/generate_sample_list/","title":"Randomization","text":""},{"location":"data_explorer/introduction/","title":"Introduction","text":""},{"location":"data_explorer/introduction/#introduction","title":"Introduction","text":"<p>Data explorer is a shiny web application based on metpipe package. It provides a series tools facilitating metabolomics data processing, exploration and visualization. </p>"},{"location":"data_explorer/match_library/","title":"Match library","text":""},{"location":"data_explorer/preprocessing/","title":"Preprocessing","text":""},{"location":"data_explorer/rt_mapping/","title":"Retention time mapping","text":""},{"location":"data_explorer/upload/","title":"Upload","text":""},{"location":"metpipe/clean/","title":"Peak cleaning","text":""},{"location":"metpipe/introduction/","title":"Introduction","text":"<p>metpipe is a R package dedicated for metabolomics data processing pipeline.</p>"},{"location":"metpipe/merge/","title":"Merge peaklist and map info","text":""},{"location":"metpipe/normalization/","title":"Normalization","text":""},{"location":"metpipe/preprocessing/","title":"Preprocessing","text":""},{"location":"metpipe/preprocessing/#some-common-parameters","title":"Some common parameters","text":"<ul> <li>m/z tolerance:</li> <li> <p>RT tolerance:</p> </li> <li> <p>peak width: ...</p> </li> </ul>"},{"location":"metpipe/qc_report/","title":"QC report","text":""},{"location":"metpipe/setup/","title":"Setup","text":""},{"location":"metpipe/tar%20-%20Copy/","title":"Targeted peak detection","text":""},{"location":"metpipe/tar%20-%20Copy/#mass-detection","title":"Mass detection","text":""},{"location":"metpipe/tar%20-%20Copy/#description","title":"Description","text":"<p> Raw data methods \u2192 Mass detection \u2192 Mass detection</p> <p>The mass detection module generates a mass list (i.e. list of m/z values and corresponding signal intensities) for each scan, in each raw data file. During the mass detection, noise filtering is performed based on a user-defined threshold (see Setting the noise level). Additionally, profile raw data are centroided.</p> <p>The available algorithms are described here.</p>"},{"location":"metpipe/tar%20-%20Copy/#parameters","title":"Parameters","text":""},{"location":"metpipe/tar%20-%20Copy/#raw-data-files","title":"Raw data files","text":"<p>Select the input raw data files for the mass detection. All the imported data files can be processed in bulk (i.e. All raw data files), or a subset can be selected directly from the MS data files panel (i.e. As selected in the main window) or based on the filename (i.e. File name pattern) As an alternative, the files' directory can be also specified (i.e. Specific raw data files). Finally, if the Those created by previous batch step option is selected, MZmine takes the output of the last processing step as input. This option is only available for batch processing.</p>"},{"location":"metpipe/tar%20-%20Copy/#scans","title":"Scans","text":"<p>Select (or filter out) the MS scans to be processed. Several filters are available (Select filters button). A scan number, RT and mobility range can be set (i.e Scan number, Retention time and Mobility options); only the scans belonging to the defined range(s) will be processed. The Base Filtering Integer option allows to prcesses one every-N scans. The Scan definition field can be used to filter scans based on the scan's description normally included in the raw file's metadata (e.g. FTMS). Scans can also be filtered by MS level (i.e. 1, 2, ..., N), polarity and spectrum type (i.e. Centroided, Profile and Thresholded).</p>"},{"location":"metpipe/tar%20-%20Copy/#scan-types-ims","title":"Scan types (IMS)","text":"<p>This parameter applies only to IM data and determines if mobility scans, frame scans or both (i.e. All scan types) are processed. For more details about mobility and frame scans, see here. Tip. Since frame scans are obtained by merging multiple mobility scans, the noise thresholds will likely be different. However, only one noise level can be set per processing step. Therefore, if one wants to run the mass detection for mobility and frame scans using different noise cutoffs, two module calls are required. As an alternative, mass detection can be performed only on the mobility scans by selecteing the appropriate noise level. Mobility scans can then be merged into frame scans with a dedicated module. </p>"},{"location":"metpipe/tar%20-%20Copy/#mass-detector","title":"Mass detector","text":"<p>Select the algorithm to be used for the mass detection. Several mass detection algorithms are available and can be selected in the drop-down menu. The choice depends on the raw data characteristics (profile/centroided, mass resolution, etc.). The Centroid algorithm must be used for already-centroided data. A step-by-step guide to convert profile into centroided data is provided in the GNPS documentation Other algorithms are available for profile raw data and are described in more details here. The Exact mass algorithm is highly recommended for profile HRMS data. When Auto is selected, the Centroid and Exact mass algorithms are used by default for centroided and profile data, respectively.</p>"},{"location":"metpipe/tar%20-%20Copy/#setting-the-noise-level","title":"Setting the noise level","text":"<p>All the mass detection algorithms allow to set a threshold for the noise filtering (i.e. Noise level) by hitting the Setup button next to the Mass detector field. A dialog box like the following will open up:  The noise threshold can be entered either in standard or scientific notation. By checking the Show preview box, an interactive visualization panel will open to help the user to adjust the noise level (see also How do I determine the noise level in my data?). The red dots denotes the mass signals retained in the mass list according to the set threshold. Different data files and scan numbers can be visualized using the corresponding drop-down menus.</p>"},{"location":"metpipe/tar%20-%20Copy/#denormalize-fragment-scans-traps","title":"Denormalize fragment scans (traps)","text":"<p>This option denormalizes scans with MS level &gt; 1, acquired with trap instruments, including Orbitrap or trapped ion mobility spectrometry (TIMS). When enabled, each scan is multiplied with the injection time resulting in \"raw\" intensities. If the injection time is missing in the data file,  the scans remain unprocessed. This option is encouraged before spectral merging to reduce the intensity differences between scans acquired with different injection times. </p>"},{"location":"metpipe/tar%20-%20Copy/#how-do-i-determine-the-noise-level-in-my-data","title":"How do I determine the noise level in my data?","text":"<p>The background noise level largely depends on the mass spectrometer and detector type. For example, Orbitrap instruments normally provides higher signal intensities than TOF devices. To provide some numbers, while 1.0E2 - 1.0E3 could be an appropriate noise level for TOF analyzers, the same would be overly low for Orbitrap instruments (which normally require 1.0E4 - 1.0E5).</p> <p>The best way to determine the instrumental noise level is undoubtedly by looking at the raw data. The background noise (often referred to as \"grass\" in technical jargon) is characterized by several signals having the same intensity and no clear pattern among them (see Figure). </p> <p></p> <p>Since these signals are produced by electrical and/or mechanical noise, rather than actual ions, they should be excluded from the mass detection and downstream data processing. The red dashed line in the figure corresponds to a hypothetical noise level (1.0E4 in this case) that would filter out most of the \"grass\"-type noise from the mass detection.</p> <p>Another way, more relevant for the feature detection, to determine the noise level consists of picking a mid-intensity LC peak and extract the EICs of its 13C isotopes. When the chromatographic peak shape starts to deteriorate, it means we are approaching the instrument detection limit (see Figure).</p> <p></p> <p>Such approach can also be useful to determine other parameters in the feature detection such as the Group intensity threshold and Min highest intensity parameters in the ADAP chromatogram builder module.</p> <p>{{ git_page_authors }}</p>"},{"location":"metpipe/tar%20-%20Copy/#targeted-feature-detection","title":"Targeted feature detection","text":""},{"location":"metpipe/tar%20-%20Copy/#description_1","title":"Description","text":"<p> Feature detection \u2192 LC-MS \u2192 Targeted feature detection</p> <p>This algorithm opens a .csv file with a list of peaks and searches for each peak in the selected raw data file.  The most crucial parameters are m/z tolerance and Retention time tolerance*, which define the window where the algorithm should find the new peak. It is centered in the m/z average and retention time average of the source peak list. Once the best candidate is found inside the window, its shape in RT direction is also checked.</p> <p>The *.csv file should have three columns:</p> <ul> <li>The first column should contain the expected M/Z,</li> <li>the second column the expected RT,</li> <li>and the third the peak name. </li> </ul> <p> Each peak should be in a different row.</p>"},{"location":"metpipe/tar%20-%20Copy/#parameters_1","title":"Parameters","text":""},{"location":"metpipe/tar%20-%20Copy/#name-suffix","title":"Name suffix","text":"<p>Suffix to be added to the peak list name.</p>"},{"location":"metpipe/tar%20-%20Copy/#peak-list-file","title":"Peak list file","text":"<p>Path of the csv file containing the list of peaks to be detected.</p>"},{"location":"metpipe/tar%20-%20Copy/#field-separator","title":"Field separator","text":"<p>Character(s) used to separate fields in the peak list file.</p>"},{"location":"metpipe/tar%20-%20Copy/#ignore-first-line","title":"Ignore first line","text":"<p>Check to ignore the first line of peak list file.</p>"},{"location":"metpipe/tar%20-%20Copy/#intensity-tolerance","title":"Intensity tolerance","text":"<p>This value sets the maximum allowed deviation from expected shape of a peak in chromatographic direction.</p>"},{"location":"metpipe/tar%20-%20Copy/#noise-level","title":"Noise level","text":"<p>The minimum intensity level for a data point to be considered part of a chromatogram. All data points below this intensity level are ignored.</p>"},{"location":"metpipe/tar%20-%20Copy/#mz-tolerance","title":"m/z Tolerance","text":"<p>Maximum allowed m/z difference to find the peak</p>"},{"location":"metpipe/tar%20-%20Copy/#retention-time-tolerance","title":"Retention time tolerance","text":"<p>Maximum allowed retention time difference to find the peak</p> <p>{{ git_page_authors }}</p>"},{"location":"metpipe/tar/","title":"Targeted processing","text":""},{"location":"metpipe/tar_untar/","title":"Targeted-untargeted processing","text":""},{"location":"metpipe/untar_msdial/","title":"Untargeted peak detection with MS-DIAL","text":""},{"location":"metpipe/untar_mzmine/","title":"Untargeted processing with MZmine","text":""},{"location":"metpipe/untar_mzmine/#raw-data-import","title":"Raw data import","text":""},{"location":"metpipe/untar_mzmine/#mass-detection","title":"Mass detection","text":""},{"location":"metpipe/untar_mzmine/#feature-processing","title":"Feature processing","text":""},{"location":"metpipe/untar_mzmine/#chromatogram-building","title":"Chromatogram building","text":""},{"location":"metpipe/untar_mzmine/#smoothing-in-retention-time-dimension-optional","title":"Smoothing in retention time dimension (optional)","text":""},{"location":"metpipe/untar_mzmine/#feature-resolving","title":"Feature resolving","text":""},{"location":"metpipe/untar_mzmine/#isotope-pattern-finder","title":"Isotope pattern finder","text":""},{"location":"metpipe/untar_mzmine/#feature-alignment","title":"Feature alignment","text":""},{"location":"metpipe/untar_mzmine/#join-aligner","title":"Join aligner","text":""},{"location":"metpipe/untar_mzmine/#gap-filling","title":"Gap-filling","text":""},{"location":"metpipe/untar_mzmine/#gap-filling-peak-finder","title":"Gap-filling (peak finder)","text":""},{"location":"metpipe/untar_mzmine/#export","title":"Export","text":""},{"location":"metpipe/untar_xcms/","title":"Untargeted processing with XCMS","text":""},{"location":"metpipe/untar_xcms/#findchrompeaks","title":"findChromPeaks","text":""},{"location":"metpipe/untar_xcms/#groupchrompeaks","title":"groupChromPeaks","text":""},{"location":"metpipe/untar_xcms/#adjustrtime-peakgroups","title":"adjustRtime - PeakGroups","text":""},{"location":"metpipe/untar_xcms/#fillchrompeaks","title":"fillChromPeaks","text":""},{"location":"workflow/calibration/","title":"Calibration","text":""},{"location":"workflow/clean/","title":"Peak cleaning","text":"<p>Metabolomics data are prone to contain artifact signals originating from sources other than the biological matrix under investigation, such as additives and preservatives incorporated during sample collection and processing, ghost peaks derived from sample preparation (e.g., derivatization), impurities present in solvents and reagents, and contaminants coming from labware and the MS system (e.g., plasticizers or column bleeding). Furthermore, these contaminants and other matrix components may accumulate in the instrument (e.g., in the autosampler or in the column) as a result of inadequate washing between sample injections, leading to the appearance of carryover signals from the foregoing samples in subsequent injections. </p>"},{"location":"workflow/clean/#based-on-blanks","title":"Based on blanks","text":"<p>Features can be considered as artifacts when  * their mean values in real samples do not exceed three times the mean values detected in blanks. * their RSD is above 15% in blanks.</p>"},{"location":"workflow/clean/#based-on-rsd","title":"Based on RSD","text":"<p>Features can be considered as artifacts when * their RSD in pool samples is above 30%. * their RSD in pool samples is above 1.5 times their RSD in samples.</p>"},{"location":"workflow/clean/#based-on-intensity","title":"Based on intensity","text":"<p>Features can be removed when thier mean intensities in pool samples are too low, such as 500.</p>"},{"location":"workflow/clean/#based-on-missing","title":"Based on missing","text":"<p>Features can be removed when too many missings existing.</p>"},{"location":"workflow/clean/#based-on-retention-time","title":"Based on retention time","text":"<p>Early eluting features should be removed.</p>"},{"location":"workflow/data_conversion/","title":"Data conversion","text":"<p>Vendor specific format such as Bruker .d and Thermo Scientific .raw sometimes are not supported in the open  source software. Therefore, we need to convert raw data to open formats such as .mzML for further processing.</p>"},{"location":"workflow/data_conversion/#msconvert-proteowizard","title":"MSConvert (ProteoWizard)","text":"<p>MSConvert supports the conversion of AB SCIEX, Agilent, Bruker, Shimadzu, Thermo Scientific, and Waters raw data. More information about the formats can be found in the  ProteoWizard Documentation for Users. Furthermore, profile data can be centroided to reduce the file size and memory consumption, which can be important when processing larger datasets.</p> <p>Recommended conversion settings for high-resolution MS data to mzML:  * Use 64 bit for m/z to retain accuracy. * Compression is optional but reduces the size significantly without much information loss - this might be instrument dependent though. * The peak picking filter needs to be the first in the list - otherwise MSConvert might default to another algorithm than the selected vendor-specific one.  * Threshold peak filter can be used to reduce some noise</p> <p></p>"},{"location":"workflow/data_structure/","title":"LC-MS data structure","text":"<p> This is the basic data structure from LC-MS analysis. The abundances of the ions are plotted as a total ion chromatogram (TIC). This plot displays the peak intensities of the analyte ions versus their RT. Further, each point in the chromatogram is associated with a mass spectrum. The mass spectrum depicts the ion abundances versus the measured m/z values.</p>"},{"location":"workflow/data_structure/#nomenclature","title":"Nomenclature","text":"<ul> <li>Total ion chromatogram (TIC): The sum of all signals across all m/z.</li> <li>Base peak chromatogram (BPC): The set containing the most intense signal for each RT across all m/z.</li> <li>Spectrum: A spectrum contains all points with a single RT value. </li> <li>Total ion spectrum (TIS): The sum of signals across all spectra. </li> <li>Extracted ion chromatogram (XIC): A slice of data containing a contiguous m/z range extending across all RT. </li> <li>Isotope trace: The signal produced by a single ion of a single analyte (i.e., a peptide or a lipid) at a particular charge state.</li> <li>Isotopic envelope trace: The group of isotopic traces produced by a single analyte at a particular charge state. </li> </ul>"},{"location":"workflow/data_structure/#ms-data-form","title":"MS data form","text":"<ul> <li>Profile (a): the raw data detected by a mass spectrometer consists of distributed signal across m/z values at each point where an ion is detected.</li> <li>Centroid (b): the raw data has been reduced to data points that represent the local maxima in a single spectrum, a distribution of data over an m/z range for a given RT.</li> </ul>"},{"location":"workflow/introduction/","title":"Introduction","text":"<p>This section provides general guidelines for the computational workflow for metabolomics data processing. </p>"},{"location":"workflow/merge/","title":"Merge peaklist and map information","text":"<p>Processed peaklist from postive and negative mode are merged into one final peaklist. </p>"},{"location":"workflow/merge/#general-procedures","title":"General procedures","text":"<ol> <li> <p>Remove redundant compounds  If certain compound is measured in both positive and negative mode, keep the entry where it has higher mean level in samples.   </p> </li> <li> <p>Map information from library  Map compound related information, such as HMDB.ID, Molecular.formula, Monoisotopic.mass, KEGG.ID, Smiles, Inchikey and metabolite class, to final output datatable. </p> </li> </ol>"},{"location":"workflow/missing_imputation/","title":"Missing imputation","text":""},{"location":"workflow/missing_imputation/#types-of-missing-values","title":"Types of missing values","text":"<ul> <li>Missing not at random (MNAR) </li> </ul> <p>Missing values caused by under the limits of quantification (LOQ) are considered as MNAR</p> <ul> <li>Missing at random (MAR) </li> </ul> <p>MAR assumes the possibility of a variable being missing is determined by other observed variables. Thus, missing values due to suboptimal data preprocessing, e.g., inaccurate peak detection and deconvolution of co-eluting compounds, can be called MAR. </p> <ul> <li>Missing completely at random (MCAR) </li> </ul> <p>Unexpected missing values are regarded as MCAR when they originate from random errors and stochastic fluctuations during the data acquisition process (e.g., incomplete derivatization or ionization).</p>"},{"location":"workflow/missing_imputation/#missing-imputation-method","title":"Missing imputation method","text":"<ul> <li>For MNAR </li> </ul> <p>LOD: Limit of Detection HM: Half of the Minimum ...</p> <ul> <li>For MAR/MCAR </li> </ul> <p>RF: Random forest KNN: k Nearest Neighbors ... </p>"},{"location":"workflow/normalization/","title":"Normalization","text":"<p>Signal drift and batch effect </p>"},{"location":"workflow/normalization/#method","title":"Method","text":""},{"location":"workflow/normalization/#general-method","title":"General method","text":"<p>Sum / Mean / Median</p> <p>Calculation: Imn / scaling factor  After normalization, all samples have the same sum / mean / median</p>"},{"location":"workflow/normalization/#internal-standard-based-method","title":"Internal standard based method","text":"<p>Best internal standard / Lowest CV NOMIS</p> <p>Calculation: Imn / ISmp  Internal standards are chosen based on CVn in pool samples</p>"},{"location":"workflow/normalization/#linear-method","title":"Linear method","text":"<p>Limma / Combat Based on linear model Consider the batch effect as a covariate and adjust for it</p>"},{"location":"workflow/normalization/#non-linear-method","title":"Non-linear method","text":"<p>Lowess Based on MA plot (LogFC vs mean)  Model paired data as a function of mean intensity</p>"},{"location":"workflow/normalization/#signal-dependent-non-linear-method","title":"Signal-dependent non-linear method","text":"<p>Qspline Based on distribution Model paired data at different quantiles as a function of mean intensity</p>"},{"location":"workflow/normalization/#evaluation","title":"Evaluation","text":"<p>PCA plot, different QC samples Pooled RSD / median absolute deviation (MAD) / variance in QC samples</p>"},{"location":"workflow/peak_grouping/","title":"Peak grouping","text":"<p>During ionization in data acquisition, an individual chemical compound gives rise to one or more ion species, which can be observed in the same mass spectrum. Those ion species include isotopologue ions, fragment ions, and in particular for electrospray ionization (ESI) adduct and cluster ions.</p> <p>For biological interpretation, we are mainly interested in the compounds, rather than the redundancy of the different ion species, which induce an undesired bloat in the number of observed features. To address these problems, two additional processing steps are desired for LC/MS data analysis: </p> <p>1) Grouping all features which are derived from the same analyte  2) Annotation of the type of ion species.</p>"},{"location":"workflow/peak_grouping/#general-procedures","title":"General procedures","text":""},{"location":"workflow/peak_grouping/#1-creating-compound-spectra-based-on-retention-time","title":"1. Creating compound spectra based on retention time","text":""},{"location":"workflow/peak_grouping/#2-isotopic-peak-detection","title":"2. Isotopic peak detection","text":""},{"location":"workflow/peak_grouping/#3-compound-spectrum-refinement-graph","title":"3. Compound spectrum refinement graph","text":""},{"location":"workflow/peak_grouping/#4-annotation-of-adducts-common-neutral-losses-and-cluster-ions","title":"4. Annotation of adducts, common neutral losses and cluster-ions","text":""},{"location":"workflow/preprocessing%20-%20Copy/","title":"Preprocessing","text":"<p>Raw data processing The raw data processing consists of essentially two steps: Data import and Mass detection</p> <p>Raw data import Either open (e.g. mzML) and native vendor (e.g. Thermo, Bruker) data formats can be imported in MZmine 3. All the supported formats are listed here (LINK to Doc). For more details see the Data import module.</p> <p>Mass detection This step produces a list (referred to as \"mass list\") of the m/z values found in each MS scan across the LC run that exceed a user-defined threeshold (i.e. noise level). For more details see the Mass detection module.</p> <p>Feature processing The goal of the \"Feature processing\" is to obtain a list of all the detected features (characterized by a RT and m/z value) from the raw LC-MS data.</p> <p>Chromatogram building The first step in the \"Feature processing\" is to build the so-called extracted ion chromatograms (EICs) for each detected mass (see \"Mass detection\"). There are two modules in MZmine 3 that can fulfil this task: ADAP chromatogram builder (widely used) and Grid mass (create docs).</p> <p>The \"detected\" features in each \ufb01le are listed in the so-called \"feature lists\", which are then further processed and aligned to connect corresponding features across all samples.</p> <p>Smoothing in retention time dimension (optional) Depending on the LC peak shape (i.e. data noisiness), the user can perform smoothing in retention time dimension. For more details see the Mass detection and Smoothing modules.</p> <p>Feature resolving Feature resolving step enables separation of co-eluting and overlapping chromatography peaks and as such is one of the pivotal steps in data preprocessing. For more detalis on the algorithm used and parameters settings, see the Local minimum resolver module.</p> <p>13C isotope filter (isotope grouper) In order to remove redundant features, such as the ones generated due to the presence of isotopologues, isotope filter should be applied. 13C isotope filter (isotope grouper) removes 13C isotope features from the feature list. Use the isotope finder for more sensitive detection of possible isotope signals.</p> <p>Isotope pattern finder Isotope pattern finder searches for the isotope signals of selected chemical elements in the mass list of each feature. The isotope pattern detected by the isotope finder module has priority over the one detected by the isotope filter (grouper) module, if both are available. For more details, see the Isotope pattern finder module.</p> <p>Feature alignment Feature alignment enables alignment of corresponding features across all samples.</p> <p>Join aligner This module aligns detected peaks in different samples through a match score. The score is calculated based on the mass and retention time of each peak and ranges of tolerance stipulated in the parameter setup dialog. For more information, see the join aligner module.</p> <p>Gap-filling Absence of features in some samples can either reflect the truth - the metabolite is absent in the given sample, or it can be due to data preprocessing.To account for this, gap filling is applied as the next step.</p> <p>Gap-filling (peak finder) Gap-filling can be performed on the aligned feature lists to cope with missing features that might be artifacts of the feature-detection process. For more details see the Gap-filling (peak finder) module.</p> <p>Export Depending on the downstream analyses, there are several export options which are accessible through Feature list methods \u2192 Export feature list.</p>"},{"location":"workflow/preprocessing/","title":"Preprocessing","text":"<p>In general, the data preprocessing procedure is shown below:</p> <p></p>"},{"location":"workflow/preprocessing/#construction-of-eics","title":"Construction of EICs","text":""},{"location":"workflow/preprocessing/#peak-detection","title":"Peak detection","text":""},{"location":"workflow/preprocessing/#issues","title":"Issues:","text":"<ul> <li>Co-eluting metabolites</li> </ul> <p>Example of deconvolution: three overlapping peaks were separated, making use of the mass spectral information. This results in a peak table with the response for all three individual metabolites and their corresponding mass spectrum</p> <ul> <li>False positive peaks</li> </ul> <p></p> <ul> <li>Difficulty in estimating boundries</li> </ul> <p></p>"},{"location":"workflow/preprocessing/#alignment","title":"Alignment","text":""},{"location":"workflow/preprocessing/#gap-filling","title":"Gap filling","text":""},{"location":"workflow/preprocessing/#identification","title":"Identification","text":""},{"location":"workflow/preprocessing/#ms1-level","title":"MS1 level","text":"<p>Based on m/z and RT:</p> <p></p>"},{"location":"workflow/preprocessing/#ms2-level","title":"MS2 level","text":"<p>Based on MS2 spectrum matching</p> <p></p>"},{"location":"workflow/preprocessing/#match-with-different-collision-energy","title":"Match with different collision energy","text":""},{"location":"workflow/qc_is/","title":"QC of internal standards","text":"<p>The implementation of quality control strategies is crucial to monitor and control data quality along the entire analytical workflow, and consequently ensure the reproducibility, accuracy, and meaningfulness of metabolomics data.</p> <p>Metabolite levels can be influenced by a myriad of preanalytical factors related to sample collection and preprocessing, conditions that must be tightly controlled to guarantee the metabolic integrity of biological samples under study. Besides, instrumental stability issues and fluctuations in analytical performance also have a negative impact on reproducibility and accuracy, especially when dealing with large-scale studies or complex samples. Along the experiment, the MS system may suffer from significant drifts in sensitivity, mass accuracy, retention time (RT), and peak resolution.</p>"},{"location":"workflow/qc_is/#quality-control-sample-types","title":"Quality control sample types","text":"<ul> <li>Blank sample (BL): Blank samples must be prepared by replacing the biological sample under study with water during the extraction process but using the same chemicals, labware, and SOPs as for real samples. </li> <li>Pool sample (PO): pool sample is prepared by mixing equal aliquots of each of the samples under investigation.</li> <li>Clinical pool sample (CP): Clinical pool sample is prepared by uning a bulk representative sample. </li> </ul> <p>All QC samples and study samples are spiked with a set of internal standards.</p>"},{"location":"workflow/qc_is/#qc-procedures","title":"QC procedures","text":"<p>The most frequent origin of systematic errors in metabolomics is deficient instrumental stability (e.g., loss in MS sensitivity or deterioration of chromatographic columns), which is ultimately mirrored in signal drifts according to the run order. </p>"},{"location":"workflow/qc_is/#detection-of-mz-rt-drift","title":"Detection of m/z, RT drift","text":"<p>To monitor the mass accuracy and retention time drifts during data aquisition, the m/z and RT of internal standards can be plotted with respect to their analytical run order to check for time-related trend in the data.   </p>"},{"location":"workflow/qc_is/#detection-of-signal-drifts","title":"Detection of signal drifts","text":"<p>The peak intensity of internal standards can be plotted against the run order to monitor the signal drift along the analytical run. PCA scores plot should be used to examine if samples show a continuous drift or a homogeneous distribution. Pool samples should ideally cluster in the center of the plot.</p>"},{"location":"workflow/randomization/","title":"Randomization","text":"<p>Randomization is used in experimental design to minimize the influence of unanticipated confounders.</p> <p></p>"},{"location":"workflow/randomization/#types-of-randomization","title":"Types of randomization","text":""},{"location":"workflow/randomization/#complete-randomization","title":"Complete randomization","text":""},{"location":"workflow/randomization/#block-randomization","title":"Block randomization","text":""},{"location":"workflow/randomization/#batch-allocation","title":"Batch allocation","text":""},{"location":"workflow/rt_prediction/","title":"Retention time prediction","text":"<p>The retention time acquired in the chromatographic system might shift due to the change of mobile phase, instrument conditions, columns, etc. Therefore, we need to update the library, i.e. predict the new retention time.</p> <p></p>"}]}